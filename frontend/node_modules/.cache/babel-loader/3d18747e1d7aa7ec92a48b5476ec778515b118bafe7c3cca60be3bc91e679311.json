{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Franz H. Dulnuan/Documents/softEng-Act/Hotel-final/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/Franz H. Dulnuan/Documents/softEng-Act/Hotel-final/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/Franz H. Dulnuan/Documents/softEng-Act/Hotel-final/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from\"react\";import{Tabs}from\"antd\";import axios from\"axios\";import Loader from\"../components/Loader\";import Error from\"../components/Error\";import Swal from\"sweetalert2\";import{Divider,Space,Tag}from'antd';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var TabPane=Tabs.TabPane;function Profilescreen(){var user=JSON.parse(localStorage.getItem(\"currentuser\"));useEffect(function(){if(!user){window.location.href=\"/login\";}},[]);return/*#__PURE__*/_jsx(\"div\",{className:\"ml-3 mt-3\",children:/*#__PURE__*/_jsxs(Tabs,{defaultActiveKey:\"1\",children:[/*#__PURE__*/_jsxs(TabPane,{tab:\"Profile\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"My Profile\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"h1\",{children:[\"Name: \",user.name]}),/*#__PURE__*/_jsxs(\"h1\",{children:[\"Email: \",user.email]}),/*#__PURE__*/_jsxs(\"h1\",{children:[\"isAdmin: \",user.isAdmin?\"YES\":\"NO\"]})]},\"1\"),/*#__PURE__*/_jsx(TabPane,{tab:\"Bookings\",children:/*#__PURE__*/_jsx(MyBookings,{})},\"2\")]})});}export default Profilescreen;export function MyBookings(){var user=JSON.parse(localStorage.getItem(\"currentuser\"));var _useState=useState([]),_useState2=_slicedToArray(_useState,2),bookings=_useState2[0],setbookings=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),loading=_useState4[0],setloading=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),error=_useState6[0],seterror=_useState6[1];useEffect(function(){function getMyBookings(){return _getMyBookings.apply(this,arguments);}function _getMyBookings(){_getMyBookings=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;// const rooms = await axios.post('/api/getbookingsbyuserid', {userid: user._id}).data\n// console.log(rooms)\nsetloading(true);_context.next=4;return axios.post(\"http://localhost:5000/api/bookings/getbookingsbyuserid\",{userid:user._id});case 4:response=_context.sent;data=response.data;console.log(data);setbookings(data);setloading(false);_context.next=16;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](0);console.log(_context.t0);setloading(false);seterror(_context.t0);case 16:case\"end\":return _context.stop();}},_callee,null,[[0,11]]);}));return _getMyBookings.apply(this,arguments);}getMyBookings();},[]);function cancelBooking(_x,_x2){return _cancelBooking.apply(this,arguments);}function _cancelBooking(){_cancelBooking=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(bookingid,roomid){var result;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.prev=0;setloading(true);_context2.next=4;return axios.post(\"http://localhost:5000/api/bookings/cancelbooking\",{bookingid:bookingid,roomid:roomid}).data;case 4:result=_context2.sent;console.log(result);setloading(false);Swal.fire(\"Congrats\",\"Booking Cancelled Successfully\",\"success\").then(function(result){window.location.reload();});_context2.next=15;break;case 10:_context2.prev=10;_context2.t0=_context2[\"catch\"](0);console.log(_context2.t0);setloading(false);Swal.fire(\"Oops\",\"Something went wrong\",\"error\");case 15:case\"end\":return _context2.stop();}},_callee2,null,[[0,10]]);}));return _cancelBooking.apply(this,arguments);}return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"col-mid-6\",children:[loading&&/*#__PURE__*/_jsx(Loader,{}),bookings&&bookings.map(function(booking){return/*#__PURE__*/_jsxs(\"div\",{className:\"bs\",children:[/*#__PURE__*/_jsx(\"h1\",{children:booking.room}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"BookingId\"}),\" : \",booking._id]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"CheckIn\"}),\" : \",booking.fromdate]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"CheckOut\"}),\" : \",booking.todate]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Amount\"}),\" : \",booking.totalamount]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Status\"}),\" :\",\" \",booking.status==\"cancelled\"?/*#__PURE__*/_jsx(Tag,{color:\"red\",children:\"CANCELLED\"}):/*#__PURE__*/_jsx(Tag,{color:\"green\",children:\"CONFIRMED\"})]}),booking.status!==\"cancelled\"&&/*#__PURE__*/_jsx(\"div\",{className:\"text-right\",children:/*#__PURE__*/_jsx(\"button\",{class:\"btn btn-primary\",onClick:function onClick(){cancelBooking(booking._id,booking.roomid);},children:\"Cancel Booking\"})})]});})]})})});}","map":{"version":3,"names":["React","useState","useEffect","Tabs","axios","Loader","Error","Swal","Divider","Space","Tag","jsx","_jsx","jsxs","_jsxs","TabPane","Profilescreen","user","JSON","parse","localStorage","getItem","window","location","href","className","children","defaultActiveKey","tab","name","email","isAdmin","MyBookings","_useState","_useState2","_slicedToArray","bookings","setbookings","_useState3","_useState4","loading","setloading","_useState5","_useState6","error","seterror","getMyBookings","_getMyBookings","apply","arguments","_asyncToGenerator","_regeneratorRuntime","mark","_callee","response","data","wrap","_callee$","_context","prev","next","post","userid","_id","sent","console","log","t0","stop","cancelBooking","_x","_x2","_cancelBooking","_callee2","bookingid","roomid","result","_callee2$","_context2","fire","then","reload","map","booking","room","fromdate","todate","totalamount","status","color","class","onClick"],"sources":["C:/Users/Franz H. Dulnuan/Documents/softEng-Act/Hotel-final/frontend/src/screens/Profilescreen.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { Tabs } from \"antd\";\r\nimport axios from \"axios\";\r\nimport Loader from \"../components/Loader\";\r\nimport Error from \"../components/Error\";\r\nimport Swal from \"sweetalert2\";\r\nimport { Divider, Space, Tag } from 'antd';\r\n\r\nconst { TabPane } = Tabs;\r\n\r\nfunction Profilescreen() {\r\n  const user = JSON.parse(localStorage.getItem(\"currentuser\"));\r\n\r\n  useEffect(() => {\r\n    if (!user) {\r\n      window.location.href = \"/login\";\r\n    }\r\n  }, []);\r\n\r\n  return (\r\n    <div className=\"ml-3 mt-3\">\r\n      <Tabs defaultActiveKey=\"1\">\r\n        <TabPane tab=\"Profile\" key=\"1\">\r\n          <h1>My Profile</h1>\r\n          <br />\r\n          <h1>Name: {user.name}</h1>\r\n          <h1>Email: {user.email}</h1>\r\n          <h1>isAdmin: {user.isAdmin ? \"YES\" : \"NO\"}</h1>\r\n        </TabPane>\r\n        <TabPane tab=\"Bookings\" key=\"2\">\r\n          <MyBookings />\r\n        </TabPane>\r\n      </Tabs>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Profilescreen;\r\n\r\nexport function MyBookings() {\r\n  const user = JSON.parse(localStorage.getItem(\"currentuser\"));\r\n  const [bookings, setbookings] = useState([]);\r\n  const [loading, setloading] = useState(false);\r\n  const [error, seterror] = useState();\r\n\r\n  useEffect(() => {\r\n    async function getMyBookings() {\r\n      try {\r\n        // const rooms = await axios.post('/api/getbookingsbyuserid', {userid: user._id}).data\r\n        // console.log(rooms)\r\n        setloading(true);\r\n        const response = await axios.post(\"http://localhost:5000/api/bookings/getbookingsbyuserid\", {\r\n          userid: user._id,\r\n        });\r\n        const data = response.data;\r\n        console.log(data);\r\n        setbookings(data);\r\n        setloading(false);\r\n      } catch (error) {\r\n        console.log(error);\r\n        setloading(false);\r\n        seterror(error);\r\n      }\r\n    }\r\n    getMyBookings();\r\n  }, []);\r\n\r\n  async function cancelBooking(bookingid, roomid) {\r\n    try {\r\n      setloading(true);\r\n      const result = await axios.post(\"http://localhost:5000/api/bookings/cancelbooking\", {\r\n        bookingid,\r\n        roomid,\r\n      }).data;\r\n      console.log(result);\r\n      setloading(false);\r\n      Swal.fire(\"Congrats\", \"Booking Cancelled Successfully\", \"success\").then(\r\n        (result) => {\r\n          window.location.reload();\r\n        }\r\n      );\r\n    } catch (error) {\r\n      console.log(error);\r\n      setloading(false);\r\n      Swal.fire(\"Oops\", \"Something went wrong\", \"error\");\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <div className=\"row\">\r\n        <div className=\"col-mid-6\">\r\n          {loading && <Loader />}\r\n          {bookings &&\r\n            bookings.map((booking) => {\r\n              return (\r\n                <div className=\"bs\">\r\n                  <h1>{booking.room}</h1>\r\n                  <p>\r\n                    <b>BookingId</b> : {booking._id}\r\n                  </p>\r\n                  <p>\r\n                    <b>CheckIn</b> : {booking.fromdate}\r\n                  </p>\r\n                  <p>\r\n                    <b>CheckOut</b> : {booking.todate}\r\n                  </p>\r\n                  <p>\r\n                    <b>Amount</b> : {booking.totalamount}\r\n                  </p>\r\n                  <p>\r\n                    <b>Status</b> :{\" \"}\r\n                    {booking.status == \"cancelled\" ? (<Tag color=\"red\">CANCELLED</Tag>) : (<Tag color=\"green\">CONFIRMED</Tag>)}\r\n                  </p>\r\n                  {booking.status !== \"cancelled\" && (\r\n                    <div className=\"text-right\">\r\n                      <button\r\n                        class=\"btn btn-primary\"\r\n                        onClick={() => {\r\n                          cancelBooking(booking._id, booking.roomid);\r\n                        }}\r\n                      >\r\n                        Cancel Booking\r\n                      </button>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              );\r\n            })}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}